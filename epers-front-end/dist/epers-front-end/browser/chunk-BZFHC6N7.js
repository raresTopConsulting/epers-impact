import{a as Be,b as Re,c as Ue}from"./chunk-PH7LKVBH.js";import{a as K,b as T}from"./chunk-J4JT2ANR.js";import{a as Q,b as X}from"./chunk-H7PKRSXN.js";import{a as De,b as Ne}from"./chunk-LFCJVXSX.js";import{a as ke}from"./chunk-WAEHDGGY.js";import{a as Oe}from"./chunk-ZLYAADV6.js";import"./chunk-GP76AYW4.js";import{h as O,j as ve,k as he}from"./chunk-7HPXOHU7.js";import{a as Le,b as je}from"./chunk-NC7IXFJV.js";import{$a as xe,Ab as we,F as l,Fb as Ae,Ga as Ce,I as _,Ia as B,J as S,Ja as be,K as N,Ka as Se,L as g,La as E,Lb as Me,Mb as Te,Na as ae,Nb as Ve,O as u,Oa as R,Qa as w,Ra as A,S as a,T as o,Ta as U,U as m,Ua as ze,V as pe,W as fe,X as h,Z as v,Za as Ie,_ as d,_a as W,ab as Pe,bb as H,cb as Fe,da as ge,ea as s,eb as G,fa as b,fb as J,g as j,ga as z,gb as Y,ia as I,ja as x,jb as M,ka as P,la as k,ma as oe,mb as Z,o as de,p as D,r as me,ra as F,sa as y,sb as $,v as p,vb as q,w as f,wb as ye,xb as Ee,ya as _e}from"./chunk-5G5VBFYZ.js";var ei=n=>["/concluzii/add",n],ii=n=>["/concluzii/istoric",n];function ti(n,i){if(n&1){let e=h();a(0,"table-header",9),v("nextPage",function(r){p(e);let c=d();return f(c.nextPage(r))})("previousPage",function(r){p(e);let c=d();return f(c.previousPage(r))})("lastPage",function(r){p(e);let c=d();return f(c.lastPage(r))})("selectItemsPerPage",function(r){p(e);let c=d();return f(c.changeItemsPerPage(r))})("serachFilter",function(r){p(e);let c=d();return f(c.filter(r))})("serachIdDDFilter",function(r){p(e);let c=d();return f(c.filterFirma(r))}),o()}if(n&2){let e=d();u("currentPage",e.currentPage)("pages",e.pages)("itemsPerPage",e.itemsPerPage)("searchCriteria",e.filtru?e.filtru:"Nume, Prenume, Matricola")("ddFilterList",e.ddFirme)("ddFilterVisible",!0)}}function ni(n,i){if(n&1){let e=h();a(0,"table-header",10),v("nextPage",function(r){p(e);let c=d();return f(c.nextPage(r))})("previousPage",function(r){p(e);let c=d();return f(c.previousPage(r))})("lastPage",function(r){p(e);let c=d();return f(c.lastPage(r))})("selectItemsPerPage",function(r){p(e);let c=d();return f(c.changeItemsPerPage(r))})("serachFilter",function(r){p(e);let c=d();return f(c.filter(r))}),o()}if(n&2){let e=d();u("currentPage",e.currentPage)("pages",e.pages)("itemsPerPage",e.itemsPerPage)("searchCriteria",e.filtru?e.filtru:"Nume, Prenume, Matricola")}}function ri(n,i){n&1&&m(0,"mat-icon",19)}function oi(n,i){n&1&&m(0,"mat-icon",20)}function ai(n,i){if(n&1&&(a(0,"tr")(1,"td"),s(2),o(),a(3,"td"),s(4),o(),a(5,"td"),s(6),o(),a(7,"td"),s(8),o(),a(9,"td"),s(10),o(),a(11,"td",11),g(12,ri,1,0,"mat-icon",12)(13,oi,1,0,"mat-icon",13),o(),a(14,"td")(15,"div",14)(16,"button",15),m(17,"mat-icon",16),s(18," Ad\u0103uga\u021Bi "),o()()(),a(19,"td")(20,"div",14)(21,"button",17),m(22,"mat-icon",18),s(23," Istoric "),o()()()()),n&2){let e=i.$implicit;l(2),b(e.numePrenume),l(2),b(e.matricolaAngajat),l(2),b(e.postAngajat),l(2),b(e.cor),l(2),b(e.dataUltimaEval),l(2),u("ngIf",e.flagFinalizat),l(),u("ngIf",!e.flagFinalizat),l(3),u("routerLink",oe(10,ei,e.idAngajat))("disabled",!e.dataEvalFin),l(5),u("routerLink",oe(12,ii,e.idAngajat))}}var ee=class le{constructor(i,e,t){this.concluziiService=i,this.firmeService=e,this.toastr=t,this.pages=0,this.currentPage=1,this.itemsPerPage=10,this.filtru="",this.filtruIdFirma=null,this.idFirmaLoggedInUser=JSON.parse(localStorage.getItem("user"))?.idFirma,this.getDDFirme(),this.tableFiltersSub=this.concluziiService.tableFiltersObs$.subscribe(r=>{this.filtru=r?.filter,this.filtruIdFirma=r?.filterFirma,this.currentPage=r?.currentPage,this.itemsPerPage=r?.itemsPerPage}),this.getListaSubalterni(this.currentPage,this.itemsPerPage,this.filtru,this.filtruIdFirma)}getDDFirme(){this.firmeSub=this.firmeService.firmeSelections$.subscribe(i=>{this.ddFirme=i})}nextPage(i){this.getListaSubalterni(i,this.itemsPerPage,this.filtru,this.filtruIdFirma)}previousPage(i){this.getListaSubalterni(i,this.itemsPerPage,this.filtru,this.filtruIdFirma)}lastPage(i){this.getListaSubalterni(i,this.itemsPerPage,this.filtru,this.filtruIdFirma)}changeItemsPerPage(i){this.currentPage=1,this.itemsPerPage=i,this.getListaSubalterni(this.currentPage,this.itemsPerPage,this.filtru,this.filtruIdFirma)}filter(i){this.filtru=i,this.currentPage=1,this.getListaSubalterni(this.currentPage,this.itemsPerPage,this.filtru,this.filtruIdFirma)}filterFirma(i){this.filtruIdFirma=i,this.currentPage=1,this.pages=0,this.getListaSubalterni(this.currentPage,this.itemsPerPage,this.filtru,this.filtruIdFirma)}getListaSubalterni(i,e,t,r){this.concluziiService.getListaSubalterni(i,e,t,r),this.listSubalterniSub=this.concluziiService.concluziiDisplayModelObs$.subscribe({next:c=>{this.listaSubalterni=c?.listaSubalterni,this.pages=c?.pages,this.currentPage=c?.currentPage},error:c=>{this.toastr.error(`Lista subalternilor nu a putut fi preluat\u0103!, ${c.message}`,"Eroare!")}})}static{this.\u0275fac=function(e){return new(e||le)(_(T),_(he),_(O))}}static{this.\u0275cmp=S({type:le,selectors:[["lista-subalterni-concluzii"]],standalone:!1,decls:29,vars:3,consts:[[1,"row"],[1,"col-12","text-center","p-4"],[1,"row","p-2","border-rounded"],["ddFilterCriteria","Firma",3,"currentPage","pages","itemsPerPage","searchCriteria","ddFilterList","ddFilterVisible","nextPage","previousPage","lastPage","selectItemsPerPage","serachFilter","serachIdDDFilter",4,"ngIf"],[3,"currentPage","pages","itemsPerPage","searchCriteria","nextPage","previousPage","lastPage","selectItemsPerPage","serachFilter",4,"ngIf"],[1,"table","p-3","table-striped","table-bordered"],[1,"table-header"],[1,"table-info"],[4,"ngFor","ngForOf"],["ddFilterCriteria","Firma",3,"nextPage","previousPage","lastPage","selectItemsPerPage","serachFilter","serachIdDDFilter","currentPage","pages","itemsPerPage","searchCriteria","ddFilterList","ddFilterVisible"],[3,"nextPage","previousPage","lastPage","selectItemsPerPage","serachFilter","currentPage","pages","itemsPerPage","searchCriteria"],[2,"text-align","center"],["color","primary","fontIcon","check",4,"ngIf"],["color","warn","fontIcon","close",4,"ngIf"],[1,"text-center"],["type","button","mat-raised-button","","color","primary",3,"routerLink","disabled"],["color","basic","fontIcon","edit"],["type","button","mat-stroked-button","","color","primary",3,"routerLink"],["color","basic","fontIcon","history"],["color","primary","fontIcon","check"],["color","warn","fontIcon","close"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"div",1)(2,"h3"),s(3,"List\u0103 Subalterni Concluzii"),o()()(),a(4,"div",2),m(5,"router-outlet"),g(6,ti,1,6,"table-header",3)(7,ni,1,4,"table-header",4),a(8,"table",5)(9,"thead",6)(10,"tr",7)(11,"th"),s(12,"Nume \u0219i prenume"),o(),a(13,"th"),s(14,"Matricol\u0103 angajat"),o(),a(15,"th"),s(16,"Post angajat"),o(),a(17,"th"),s(18,"COR angajat"),o(),a(19,"th"),s(20,"Data ultimei evalu\u0103ri"),o(),a(21,"th"),s(22,"Evaluare finalizat\u0103"),o(),a(23,"th"),s(24,"Concluzii"),o(),a(25,"th"),s(26,"Istoric Concluzii"),o()()(),a(27,"tbody"),g(28,ai,24,14,"tr",8),o()()()),e&2&&(l(6),u("ngIf",!t.idFirmaLoggedInUser),l(),u("ngIf",t.idFirmaLoggedInUser),l(21),u("ngForOf",t.listaSubalterni))},dependencies:[Le,F,y,w,A,be,E],encapsulation:2})}};ee=j([R({checkProperties:!0})],ee);var Ye={CALIFICATIV_MINIM_INSUFICIENT:1.5,CALIFICATIV_MINIM_NECESITA_EFORT:2.5};var Ze=(()=>{class n{constructor(e){this.httpClient=e,this.baseUrl=Ce.baseUrl}sendEmailConcluzii(e){this.httpClient.get(this.baseUrl+"/EmailConcluzii/?idAngajat="+e).subscribe()}static{this.\u0275fac=function(t){return new(t||n)(me(_e))}}static{this.\u0275prov=de({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function ci(n,i){if(n&1&&(pe(0),m(1,"curs-recomandat-details",10),fe()),n&2){let e=i.$implicit;l(),u("idCurs",e)}}function si(n,i){if(n&1&&(a(0,"div",6)(1,"h5"),s(2,"Training-uri recomandate:"),o(),g(3,ci,2,1,"ng-container",9),o()),n&2){let e=d(2);l(3),u("ngForOf",e.concluzie.displayIdsTraining)}}function ui(n,i){if(n&1&&(a(0,"div",1)(1,"div",2)(2,"h5"),s(3,"Concluzii despre rezultatele evalu\u0103rii competen\u021Belor \u0219i despre activit\u0103\u021Bile de dezvoltare profesional\u0103 "),o(),a(4,"div",3),m(5,"textarea",4),o()(),a(6,"div",2)(7,"h5"),s(8,"Concluzii despre evaluarea cantitativ\u0103 a obiectivelor \u0219i despre setarea noilor obiective"),o(),a(9,"div",3),m(10,"textarea",5),o()(),a(11,"div",6)(12,"h5"),s(13,"A\u0219tept\u0103ri angajat \u0219i aspecte generale"),o(),a(14,"div",3),m(15,"textarea",7),o()(),g(16,si,4,1,"div",8),o()),n&2){let e=d();l(5),u("textContent",e.concluzie.concluziiEvalCompActDezProf),l(5),u("textContent",e.concluzie.concluziiEvalCantOb),l(5),u("textContent",e.concluzie.concluziiAspecteGen),l(),u("ngIf",e.concluzie&&e.concluzie.displayIdsTraining&&e.concluzie.displayIdsTraining.length>0)}}var ie=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=S({type:n,selectors:[["concluzii-details"]],inputs:{concluzie:"concluzie"},standalone:!1,decls:1,vars:1,consts:[["class","row",4,"ngIf"],[1,"row"],[1,"col-6","py-1"],[1,"form-outline"],["id","ist-conc_eval_comp_act_prof","rows","5","name","concluziiEvalCompActDezProf","disabled","",1,"form-control",3,"textContent"],["id","ist-conc_eval_cant_ob","rows","5","name","concluziiEvalCantOb","disabled","",1,"form-control",3,"textContent"],[1,"col-12","py-1"],["id","ist-conc_astept_ang_gen","rows","4","name","concluziiAspecteGen","disabled","",1,"form-control",3,"textContent"],["class","col-12 py-1",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"idCurs"]],template:function(t,r){t&1&&g(0,ui,17,4,"div",0),t&2&&u("ngIf",r.concluzie)},dependencies:[F,y,De],encapsulation:2})}}return n})();var Ci=()=>["../../listaSubalterni"];function vi(n,i){if(n&1&&(a(0,"option",19),s(1),o()),n&2){let e=i.$implicit;u("value",e),l(),b(e)}}function hi(n,i){if(n&1&&(a(0,"option",19),s(1),o()),n&2){let e=i.$implicit;u("value",e.Id),l(),z("",e.Text," ")}}function bi(n,i){if(n&1){let e=h();a(0,"div",7)(1,"button",20),v("click",function(){p(e);let r=d();return f(r.openPipAddModal())}),m(2,"mat-icon",21),s(3," \xA0 Start PIP "),o()()}}function Si(n,i){if(n&1){let e=h();a(0,"div",7)(1,"button",20),v("click",function(){p(e);let r=d();return f(r.openPipEditModal())}),m(2,"mat-icon",22),s(3),o()()}if(n&2){let e=d();l(3),z(" \xA0 ",e.userHasPipRespins?"Refacere PIP":"Finalizare PIP"," ")}}function zi(n,i){if(n&1){let e=h();a(0,"div",7)(1,"button",20),v("click",function(){p(e);let r=d();return f(r.openPipDetailsModal())}),m(2,"mat-icon",23),s(3," \xA0 Vizualizare PIP "),o()()}}function Ii(n,i){if(n&1&&(a(0,"div",7)(1,"h6"),s(2,"Calificativul final al evalu\u0103rii: "),a(3,"button",24),s(4),o(),s(5),o()()),n&2){let e=d();l(4),b(e.istoricEvalCalificativ.calificativFinal),l(),z("\xA0 ",e.istoricEvalCalificativ.incadrareCalificativFinal," ")}}function xi(n,i){n&1&&(a(0,"div",7)(1,"p",25),m(2,"mat-icon",26),s(3," Aten\u021Bie, nu exit\u0103 evaluare finalizat\u0103 pentru anul selectat."),o()())}function Pi(n,i){n&1&&(a(0,"div",1)(1,"p",25),m(2,"mat-icon",26),s(3," Aten\u021Bie, concluziile evalu\u0103rii nu pot fi completate p\xE2n\u0103 ce Planul de \xCEmbun\u0103t\u0103\u021Bire a Performan\u021Belor nu a fost \xEEncheiat."),o()())}function Fi(n,i){if(n&1){let e=h();a(0,"button",32),v("click",function(){p(e);let r=d().$implicit,c=d(2);return f(c.removeCurs(r.Id))}),a(1,"mat-icon"),s(2,"cancel"),o()()}}function yi(n,i){if(n&1){let e=h();a(0,"mat-chip",30),v("removed",function(){let r=p(e).$implicit,c=d(2);return f(c.removeCurs(r.Id))}),s(1),g(2,Fi,3,0,"button",31),o()}if(n&2){let e=i.$implicit;l(),z(" ",e.Text," "),l(),u("ngIf",e)}}function Ei(n,i){if(n&1&&(a(0,"div",27)(1,"mat-list",28),g(2,yi,3,2,"mat-chip",29),o()()),n&2){let e=d();l(2),u("ngForOf",e.cursuriSelectate)}}function wi(n,i){if(n&1&&(a(0,"div",1)(1,"p",33),m(2,"mat-icon",34),s(3),o()()),n&2){let e=d();l(3),z(" Aten\u021Bie, Concluzile evalu\u0103rii pe anul ",e.yearFilter," au fost completate! ")}}function Ai(n,i){if(n&1&&m(0,"concluzii-details",35),n&2){let e=d();u("concluzie",e.concluzie)}}function Mi(n,i){if(n&1){let e=h();a(0,"div",1)(1,"div",36)(2,"h5"),s(3,"Concluzii despre rezultatele evalu\u0103rii competen\u021Belor \u0219i despre activit\u0103\u021Bile de dezvoltare profesional\u0103 "),o(),a(4,"div",37)(5,"textarea",38),P("ngModelChange",function(r){p(e);let c=d();return x(c.concluzie.concluziiEvalCompActDezProf,r)||(c.concluzie.concluziiEvalCompActDezProf=r),f(r)}),o()()(),a(6,"div",36)(7,"h5"),s(8,"Concluzii despre evaluarea cantitativ\u0103 a obiectivelor \u0219i despre setarea noilor obiective "),a(9,"span",39),v("click",function(){p(e);let r=d();return f(r.addConcluziiCantitative=!r.addConcluziiCantitative)}),m(10,"mat-icon",40),o()(),a(11,"div",37)(12,"textarea",41),P("ngModelChange",function(r){p(e);let c=d();return x(c.concluzie.concluziiEvalCantOb,r)||(c.concluzie.concluziiEvalCantOb=r),f(r)}),o()()(),a(13,"div",42)(14,"h5"),s(15,"A\u0219tept\u0103ri angajat \u0219i aspecte generale"),o(),a(16,"div",37)(17,"textarea",43),P("ngModelChange",function(r){p(e);let c=d();return x(c.concluzie.concluziiAspecteGen,r)||(c.concluzie.concluziiAspecteGen=r),f(r)}),o()()()()}if(n&2){let e=d();l(5),I("ngModel",e.concluzie.concluziiEvalCompActDezProf),l(7),I("ngModel",e.concluzie.concluziiEvalCantOb),u("disabled",!e.addConcluziiCantitative),l(5),I("ngModel",e.concluzie.concluziiAspecteGen)}}var te=class se{constructor(i,e,t,r,c,C,ne,L,re){this.route=i,this.router=e,this.concluzieService=t,this.emailConcluziiService=r,this.evalService=c,this.pipService=C,this.dialog=ne,this.ddStateService=L,this.toastr=re,this.cursuriSelection=[],this.cursuriSelectate=[],this.showAddPip=!1,this.years=Array.from({length:50},(ue,Qe)=>2022+Qe),this.addConcluziiCantitative=!1,this.concluzie={},this.route.params.subscribe(ue=>{this.idAngajat=+ue.id}),this.yearFilter=new Date().getFullYear(),this.idFirmaLoggedInUser=JSON.parse(localStorage.getItem("user"))?.idFirma}ngOnInit(){this.cusrusiSelectionSub=this.ddStateService.appDropdownsSubject$.subscribe(i=>{this.cursuriSelection=i?.DdCursuri,this.idFirmaLoggedInUser&&(this.cursuriSelection=i?.DdCursuri?.filter(e=>e.IdFirma===this.idFirmaLoggedInUser))}),this.searchConcluzie(),this.showAddPipSub=this.pipService.hasMediaForPip(this.idAngajat,this.yearFilter).subscribe(i=>{this.showAddPip=i}),this.stareActualaPipSub=this.pipService.getStareActualaPip(this.idAngajat,this.yearFilter).subscribe(i=>{i&&(this.userHasPip=!!i?.id,this.userHasPipNefinalizat=i.id&&i.id>1&&i.id<4,this.userHasPipRespins=i.id===3)})}openPipAddModal(){let i=new M;i.disableClose=!0,i.autoFocus=!0,i.width="60%",i.height="80%",i.data={idAngajat:this.idAngajat},this.dialog.open(Re,i)}openPipDetailsModal(){let i=new M;i.disableClose=!0,i.autoFocus=!0,i.width="60%",i.height="80%",i.data={idAngajat:this.idAngajat},this.dialog.open(X,i)}openPipEditModal(){let i=new M;i.disableClose=!0,i.autoFocus=!0,i.width="60%",i.height="80%",i.data={idAngajat:this.idAngajat},this.dialog.open(Be,i)}searchConcluzie(){this.getConcluzii(this.idAngajat,this.yearFilter),this.getIstoricEvalCalificativFinal(this.idAngajat,this.yearFilter),this.getEvaluariForConcluzie(this.idAngajat,this.yearFilter)}save(){this.cursuriSelectate&&this.cursuriSelectate.length>0&&this.cursuriSelectate.forEach(i=>{i&&i.Id&&(this.concluzie.idTraining===null&&(this.concluzie.idTraining=""),this.concluzie.idTraining+=i.Id.toString()+",")}),this.concluzieService.addConcluzie(this.concluzie,this.idEvaluari).subscribe({next:()=>{this.toastr.success("Concluziile au fost salvate cu succes!"),this.emailConcluziiService.sendEmailConcluzii(this.idAngajat),setTimeout(()=>{this.router.navigate(["../../listaSubalterni"],{relativeTo:this.route})},500)},error:i=>{this.toastr.error(i?.error?.message)}})}selectCurs(i){let e=this.cursuriSelection.find(t=>t.Id===+i);this.cursuriSelectate.map(t=>t.Id!==+i)&&this.cursuriSelectate.length<5&&this.cursuriSelectate.push({Id:+i,Text:e.Text,IdFirma:e.IdFirma,Value:e.Value})}removeCurs(i){let e=this.cursuriSelectate.findIndex(t=>t.Id===i);this.cursuriSelectate.splice(e,1)}getConcluzii(i,e){this.concluziiAnulSelectatSub=this.concluzieService.getIstoric(i,e).subscribe(t=>{t?this.concluzie=t:this.concluzie={},this.existaConcluzii=!!this.concluzie?.concluziiAspecteGen||!!this.concluzie?.concluziiEvalCantOb||!!this.concluzie?.concluziiEvalCompActDezProf||!!this.concluzie?.idTraining})}getIstoricEvalCalificativFinal(i,e){this.istoricEvalCalifFinSub=this.evalService.getIstoricEvalCalificativFinal(i,e).subscribe(t=>{t&&(this.istoricEvalCalificativ=t,t.calificativFinal&&t.calificativFinal<=Ye.CALIFICATIV_MINIM_NECESITA_EFORT&&(this.showAddPip=!0))})}getEvaluariForConcluzie(i,e){this.idsEvaluariSubalternSub=this.concluzieService.getIdsEvaluariSubaltern(i,e).subscribe(t=>{this.idEvaluari=t})}static{this.\u0275fac=function(e){return new(e||se)(_(B),_(Se),_(T),_(Ze),_(K),_(Q),_(Z),_(ve),_(O))}}static{this.\u0275cmp=S({type:se,selectors:[["concluzie-add"]],standalone:!1,decls:42,vars:19,consts:[["concluziiFrom","ngForm"],[1,"row"],[1,"col-12","text-center","p-4"],[3,"idAngajat"],[3,"ngSubmit"],[1,"row","py-3"],[1,"col-12","py-3"],[1,"col-auto"],["name","yearFilter",1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["id","conc-curs","name","curs",1,"form-select","form-select-sm",3,"ngModelChange","ngModel","disabled"],["class","col-auto",4,"ngIf"],["class","row",4,"ngIf"],["class","col-12",4,"ngIf"],[3,"concluzie",4,"ngIf"],[1,"row","pt-1"],[1,"col-6"],[3,"routerLink"],[3,"disabled"],[3,"value"],["type","button","mat-raised-button","","color","primary",1,"form-control",3,"click"],["color","basic","fontIcon","add"],["color","basic","fontIcon","edit"],["color","basic","fontIcon","info"],["type","button","color","primary","mat-mini-fab",""],[1,"warning"],["fontIcon","info"],[1,"col-12"],["aria-label","Cursuri Selectate"],["removable","",3,"removed",4,"ngFor","ngForOf"],["removable","",3,"removed"],["mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],[1,"col-12","warning","alert","alert-warning"],["color","accent","fontIcon","info"],[3,"concluzie"],[1,"col-6","py-1"],[1,"form-outline"],["id","conc_eval_comp_act_prof","rows","5","name","concluziiEvalCompActDezProf","placeholder","Rezultatele evalu\u0103rii competen\u021Belor \u0219i activit\u0103\u021Bile de dezvoltare profesional\u0103",1,"form-control",3,"ngModelChange","ngModel"],["mat-fab","","color","primary","matTooltip","Ad\u0103uga\u021Bi concluziile privind evaluarea cantitativ\u0103",3,"click"],["color","primary","fontIcon","edit"],["id","conc_eval_cant_ob","rows","5","name","concluziiEvalCantOb","placeholder","Evaluarea cantitativ\u0103 a obiectivelor \u0219i setarea noilor obiective",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"col-12","py-1"],["id","conc_astept_ang_gen","rows","4","name","concluziiAspecteGen","placeholder","A\u0219tept\u0103ri angajat \u0219i aspecte generale",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,t){if(e&1){let r=h();a(0,"div",1)(1,"div",2)(2,"h3"),s(3,"Concluzii"),o()()(),m(4,"userdata-header",3),a(5,"form",4,0),v("ngSubmit",function(){return p(r),f(t.save())}),a(7,"div",5),m(8,"hr"),a(9,"div",6)(10,"div",1)(11,"div",7)(12,"mat-label"),s(13,"Anul:"),o()(),a(14,"div",7)(15,"select",8),P("ngModelChange",function(C){return p(r),x(t.yearFilter,C)||(t.yearFilter=C),f(C)}),v("ngModelChange",function(){return p(r),f(t.searchConcluzie())}),g(16,vi,2,2,"option",9),o()(),a(17,"div",7)(18,"h5"),s(19,"Recomanda\u021Bi cursuri (max. 5)"),o()(),a(20,"div",7)(21,"select",10),P("ngModelChange",function(C){return p(r),x(t.cursSelectat,C)||(t.cursSelectat=C),f(C)}),v("ngModelChange",function(C){return p(r),f(t.selectCurs(C))}),g(22,hi,2,2,"option",9),o()(),g(23,bi,4,0,"div",11)(24,Si,4,1,"div",11)(25,zi,4,0,"div",11),o(),m(26,"br"),a(27,"div",1),g(28,Ii,6,2,"div",11)(29,xi,4,0,"div",11),o(),g(30,Pi,4,0,"div",12),a(31,"div",1),g(32,Ei,3,1,"div",13),o(),g(33,wi,4,1,"div",12),o(),m(34,"hr"),g(35,Ai,1,1,"concluzii-details",14)(36,Mi,18,4,"div",12),o(),a(37,"div",15)(38,"div",16),m(39,"cancel-button",17),o(),a(40,"div",16),m(41,"save-button",18),o()()()}if(e&2){let r=ge(6);l(4),u("idAngajat",t.idAngajat),l(11),I("ngModel",t.yearFilter),l(),u("ngForOf",t.years),l(5),I("ngModel",t.cursSelectat),u("disabled",t.existaConcluzii),l(),u("ngForOf",t.cursuriSelection),l(),u("ngIf",t.showAddPip&&!t.userHasPip),l(),u("ngIf",t.userHasPipNefinalizat),l(),u("ngIf",t.userHasPip),l(3),u("ngIf",t.istoricEvalCalificativ&&(t.istoricEvalCalificativ==null?null:t.istoricEvalCalificativ.calificativFinal)&&t.yearFilter>=2024),l(),u("ngIf",!t.idEvaluari||t.idEvaluari.length<=0),l(),u("ngIf",t.showAddPip&&!t.userHasPip),l(2),u("ngIf",t.cursuriSelectate&&t.cursuriSelectate.length>0),l(),u("ngIf",t.existaConcluzii),l(2),u("ngIf",t.existaConcluzii),l(),u("ngIf",!t.existaConcluzii),l(3),u("routerLink",k(18,Ci)),l(2),u("disabled",!r.valid||t.existaConcluzii)}},dependencies:[F,y,Fe,J,Y,Ie,G,W,xe,H,Pe,w,A,ze,U,$,Ae,q,ye,Ee,Me,Te,E,ie],encapsulation:2})}};te=j([R({checkProperties:!0})],te);var Ti=()=>["../../listaSubalterni"];function Vi(n,i){if(n&1&&(a(0,"option",15),s(1),o()),n&2){let e=i.$implicit;u("value",e),l(),b(e)}}function Li(n,i){if(n&1){let e=h();a(0,"div",7)(1,"button",11),v("click",function(){p(e);let r=d();return f(r.openPipDetailsModal())}),m(2,"mat-icon",16),s(3," \xA0 Vizualizare PIP "),o()()}}function ji(n,i){if(n&1&&(a(0,"div",7)(1,"h6"),s(2,"Calificativul final al evalu\u0103rii: "),a(3,"button",17),s(4),o(),s(5),o()()),n&2){let e=d();l(4),b(e.istoricEvalCalificativ.calificativFinal),l(),z("\xA0 ",e.istoricEvalCalificativ.incadrareCalificativFinal," ")}}var qe=(()=>{class n{constructor(e,t,r,c,C,ne){this.route=e,this.pipService=t,this.concluzieService=r,this.dialog=c,this.pdfService=C,this.evalService=ne,this.years=Array.from({length:50},(L,re)=>2022+re),this.concluziiPdf=ke.CONCLUZII,this.concluzie={},this.route.params.subscribe(L=>{this.idAngajat=+L.id}),this.yearFilter=new Date().getFullYear()}ngOnInit(){this.searchConcluzie()}searchConcluzie(){this.concluziiSub=this.concluzieService.getIstoric(this.idAngajat,this.yearFilter).subscribe(e=>{this.concluzie=e}),this.checkIfHasPip(this.idAngajat,this.yearFilter),this.getIstoricEval(this.idAngajat,this.yearFilter)}openPipDetailsModal(){let e=new M;e.disableClose=!0,e.autoFocus=!0,e.width="60%",e.height="80%",e.data={idAngajat:this.idAngajat},this.dialog.open(X,e)}getIstoricEval(e,t){this.istoricEvalCalifFinSub=this.evalService.getIstoricEvalCalificativFinal(this.idAngajat,t).subscribe(r=>{r&&(this.istoricEvalCalificativ=r)})}checkIfHasPip(e,t){this.pipServiceSub=this.pipService.getStareActualaPip(e,t).subscribe(r=>{this.userHasPip=!!r.id})}generatePDF(){this.pdfServiceSub=this.pdfService.getEvaluareConcluziiPdf(this.idAngajat,this.yearFilter).subscribe(e=>{let t=this.pdfService.base64ToBlob(e.fileContents,e.contentType),r=URL.createObjectURL(t);window.open(r,"_blank")})}ngOnDestroy(){this.concluziiSub?.unsubscribe(),this.pipServiceSub?.unsubscribe(),this.istoricEvalCalifFinSub?.unsubscribe(),this.pdfServiceSub?.unsubscribe()}static{this.\u0275fac=function(t){return new(t||n)(_(B),_(Q),_(T),_(Z),_(Oe),_(K))}}static{this.\u0275cmp=S({type:n,selectors:[["istoric-concluzii"]],standalone:!1,decls:27,vars:8,consts:[[1,"row"],[1,"col-12","text-center","p-4"],[3,"idAngajat"],[1,"row","pt-1"],[1,"col-12"],[1,"p-4","border","rounded"],[1,"form-group","row","p-2"],[1,"col-auto"],["name","yearFilter",1,"form-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","col-auto",4,"ngIf"],["type","button","mat-raised-button","","color","accent",1,"form-control",3,"click"],["color","basic","fontIcon","print"],[3,"concluzie"],[3,"routerLink"],[3,"value"],["color","basic","fontIcon","info"],["type","button","color","accent","mat-mini-fab",""]],template:function(t,r){t&1&&(a(0,"div",0)(1,"div",1)(2,"h3"),s(3,"Istoric Concluzii"),o()()(),m(4,"userdata-header",2),a(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"mat-label"),s(11,"Anul:"),o()(),a(12,"div",7)(13,"select",8),P("ngModelChange",function(C){return x(r.yearFilter,C)||(r.yearFilter=C),C}),v("ngModelChange",function(){return r.searchConcluzie()}),g(14,Vi,2,2,"option",9),o()(),g(15,Li,4,0,"div",10),a(16,"div",7)(17,"button",11),v("click",function(){return r.generatePDF()}),m(18,"mat-icon",12),s(19," \xA0 PDF Istoric Evaluare "),o()()(),m(20,"br"),a(21,"div",0),g(22,ji,6,2,"div",10),o(),m(23,"concluzii-details",13),o()()(),a(24,"div",3)(25,"div",4),m(26,"back-button",14),o()()),t&2&&(l(4),u("idAngajat",r.idAngajat),l(9),I("ngModel",r.yearFilter),l(),u("ngForOf",r.years),l(),u("ngIf",r.userHasPip),l(7),u("ngIf",r.istoricEvalCalificativ&&(r.istoricEvalCalificativ==null?null:r.istoricEvalCalificativ.calificativFinal)&&r.yearFilter>=2024),l(),u("concluzie",r.concluzie),l(3),u("routerLink",k(7,Ti)))},dependencies:[F,y,J,Y,G,W,H,w,A,U,$,q,we,E,ie],encapsulation:2})}}return n})();var Di=[{path:"listaSubalterni",component:ee},{path:"add/:id",component:te},{path:"istoric/:id",component:qe}],Ke=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=N({type:n})}static{this.\u0275inj=D({imports:[ae.forChild(Di),ae]})}}return n})();var At=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=N({type:n})}static{this.\u0275inj=D({imports:[je,Ve,Ke,Ne,Ue]})}}return n})();export{At as ConcluziiModule};
