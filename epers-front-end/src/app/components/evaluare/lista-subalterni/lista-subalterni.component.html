<div class="row">
  <div class="col-12 text-center p-4">
    <h3>Listă Subalterni Competențe</h3>
  </div>
</div>
<div class="row p-2 border-rounded">
  <router-outlet></router-outlet>

  @if (!idFirmaLoggedInUser) {
    <table-header [currentPage]="currentPage" [pages]="pages" [itemsPerPage]="itemsPerPage" (nextPage)="nextPage($event)"
      (previousPage)="previousPage($event)" (lastPage)="lastPage($event)"
      (selectItemsPerPage)="changeItemsPerPage($event)" (serachFilter)="filter($event)"
      [searchCriteria]="filtru ? filtru: 'Nume, Prenume, Matricola'" [ddFilterList]="ddFirme" [ddFilterVisible]="true" (serachIdDDFilter)="filterFirma($event)" ddFilterCriteria="Firma">
    </table-header>
  }

  @if (idFirmaLoggedInUser) {
    <table-header [currentPage]="currentPage" [pages]="pages" [itemsPerPage]="itemsPerPage" (nextPage)="nextPage($event)"
      (previousPage)="previousPage($event)" (lastPage)="lastPage($event)"
      (selectItemsPerPage)="changeItemsPerPage($event)" (serachFilter)="filter($event)"
      [searchCriteria]="filtru ? filtru : 'Nume, Prenume, Matricola'">
    </table-header>
  }

  <table class="table p-3 table-striped table-bordered">
    <thead class="table-header">
      <tr class="table-info">
        <th>Nume și prenume</th>
        <th>Matricolă angajat</th>
        <th>Post angajat</th>
        <th>COR angajat</th>
        <th>Data ultimei evaluări</th>
        <th>Evaluare finalizată {{currentYear}}</th>
        <th>Note angajat</th>
        <th>Detalii</th>
        <th>Evaluare subaltern</th>
        <th>Evaluare finală</th>
      </tr>
    </thead>
    @if (!tableIsLoading) {
      <tbody>
        @for (evalSubalt of listaSubalterni; track evalSubalt; let i = $index) {
          <tr>
            <td>{{evalSubalt.numePrenume}}</td>
            <td>{{evalSubalt.matricolaAngajat}}</td>
            <td>{{evalSubalt.postAngajat}}</td>
            <td>{{evalSubalt.cor}}</td>
            <td>{{evalSubalt.dataUltimaEval}}</td>
            <td style="text-align: center;">
              @if (evalSubalt.finaliztAnulCurent) {
                <mat-icon color="primary" fontIcon="check"></mat-icon>
              }
              @if (!evalSubalt.finaliztAnulCurent) {
                <mat-icon color="warn" fontIcon="close"></mat-icon>
              }
            </td>
            <td>
              <div class="text-center">
                <button type="button" mat-stroked-button color="accent"
                  matTooltip="Mențiuni pe parcursul anului {{currentYear}}"
                  [routerLink]="['/evaluare/mentiuni', evalSubalt.idAngajat]">
                  <mat-icon color="basic" fontIcon="info"></mat-icon>
                  Mențiuni
                </button>
              </div>
            </td>
            <td>
              <div class="text-center">
                <button type="button" mat-stroked-button color="primary"
                  [routerLink]="['/evaluare/istoric', evalSubalt.idAngajat]">
                  <mat-icon color="basic" fontIcon="history"></mat-icon>
                  Istoric
                </button>
              </div>
            </td>
            <td>
              <!-- <div class="text-center" *ngIf="evalSubalt.finaliztAnulCurent">
              <button type="button" mat-raised-button color="primary" disabled>
                <mat-icon color="basic" fontIcon="edit"></mat-icon>
                Eval. Finalizată
              </button>
            </div> -->
            <!-- <div class="text-center" *ngIf="!evalSubalt.finaliztAnulCurent"> -->
            <button type="button" mat-raised-button color="primary"
              [disabled]="!!evalSubalt.dataAutoEval && !!evalSubalt.dataEvalSef && !!evalSubalt.dataEvalFin && !evalSubalt.flagFinalizat"
              [routerLink]="['/evaluare/evaluareSubaltern', evalSubalt.idAngajat]">
              <mat-icon color="basic" fontIcon="edit"></mat-icon>
              Evaluați
            </button>
          <!-- </div> -->
        </td>
        <td>
          <!-- *ngIf="((evalSubalt.dataEvalSef && evalSubalt.dataAutoEval) && !evalSubalt.dataEvalFin) && !evalSubalt.finaliztAnulCurent" -->
          <div class="text-center">
            <button type="button" mat-raised-button color="primary"
              [routerLink]="['/evaluare/evaluareFinala', evalSubalt.idAngajat]">
              <mat-icon color="basic" fontIcon="edit"></mat-icon>
              Eval. Finală
            </button>
          </div>
          <!-- <div class="text-center" *ngIf="evalSubalt.finaliztAnulCurent">
          <button type="button" mat-raised-button color="primary" disabled>
            <mat-icon color="basic" fontIcon="edit"></mat-icon>
            Eval. Finalizată
          </button>
        </div>
        <div class="text-center"
          *ngIf="(((evalSubalt.dataEvalSef && !evalSubalt.dataAutoEval) || (!evalSubalt.dataEvalSef && evalSubalt.dataAutoEval)) && !evalSubalt.dataEvalFin) && !evalSubalt.finaliztAnulCurent">
          <button type="button" mat-raised-button color="primary" disabled>
            <mat-icon color="basic" fontIcon="edit"></mat-icon>
            Eval. Finală
          </button>
        </div> -->
      </td>
    </tr>
  }
</tbody>
}
</table>
<div class="row">
  @if (tableIsLoading) {
    <div class="col-6">
      <mat-spinner></mat-spinner>
    </div>
  }
</div>
</div>